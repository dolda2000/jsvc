<?xml version="1.0"?>

<project name="haven-jsvc" default="jsvc-jar">
    
   <property environment="env" />

   <!--
   <path id="classpath">
      <pathelement path="${env.CATALINA_HOME}/common/lib/servlet-api.jar" />
   </path>
   -->
    
   <target name="build-env">
      <mkdir dir="build" />
      <mkdir dir="build/classes" />
      <mkdir dir="build/webapp" />
      <mkdir dir="build/webapp/WEB-INF/classes" />
    </target>

    <target name="jsvc" depends="build-env">
      <javac srcdir="src" destdir="build/classes" debug="on">
	<!-- <classpath refid="classpath" /> -->
        <compilerarg value="-Xlint:unchecked" />
      </javac>
    </target>
    
    <target name="jsvc-jar" depends="build-env, jsvc">
        <jar destfile="build/jsvc.jar" basedir="build/classes" />
    </target>
    
    <target name="webapp" depends="build-env">
       <mkdir dir="build/webapp/WEB-INF/lib" />
       <copy file="build/jsvc.jar" tofile="build/webapp/WEB-INF/lib/jsvc.jar" />
       <copy todir="build/webapp/WEB-INF/lib">
	  <fileset dir="lib" />
       </copy>
    </target>

    <target name="war" depends="build-env, jsvc-jar, webapp">
       <war destfile="build/jsvc.war"
	    basedir="build/webapp"
	    webxml="www/web.xml"
	    />
    </target>

    <target name="clean">
       <delete dir="build" />
    </target>
</project>
